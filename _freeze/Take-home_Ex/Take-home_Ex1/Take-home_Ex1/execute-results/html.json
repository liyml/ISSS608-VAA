{
  "hash": "51a11908a0dbdc1c46574ee3482a0749",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1\"\nauthor: \"Lai Meihao\"\ndate: \"February 1, 2025\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n\n# Take Home Exercise 1\n\n# Overview\n\n------------------------------------------------------------------------\n\n## Background\n\nA heart attack occurs when blood flow to the heart muscle is reduced or blocked, leading to potential damage of heart tissue. The severity and recovery time can vary significantly based on multiple risk factors.\n\nRecent studies have highlighted a worrying increase in heart-related issues among younger adults, with data showing cardiovascular disease manifestation in people under 45. This trend is particularly noteworthy as it challenges the traditional understanding of heart disease as primarily affecting older populations. Key risk factors being monitored include cholesterol levels, blood pressure, BMI, and lifestyle factors such as physical activity, diet quality, and stress levels.\n\n**The objective of this analysis is to:**\n\n1.  Examine the patterns of cardiovascular risk factors across five distinct age groups in the Japanese population\n\n2.  Investigate risk factor variations in different life stages\n\n3.  Compare cardiovascular health profiles across all age categories\n\n**Methodology**:\n\n-   Applied Exploratory Data Analysis (EDA) methods using the tidyverse family of packages\n\n-   Utilized statistical visualization techniques through ggplot2 and its extensions\n\n-   Implemented statistical testing to examine relationships between age groups and risk factors\n\n-   Created multi-dimensional visualizations to understand risk factor patterns across age groups\n\nThis analysis aims to contribute to understanding of how cardiovascular risks manifest across different age groups in Japan.\n\n## The Dataset\n\nThe dataset offers an in-depth exploration of heart attack incidents in Japan, focusing on the differences between youth (\\<45) and adult (≥45) age groups. By analyzing key cardiovascular risk factors such as cholesterol levels, blood pressure, and BMI, alongside lifestyle factors including physical activity, diet quality, and stress levels, it provides valuable insights into the health profiles and potential triggers associated with heart attacks across age and gender demographics in the Japanese population.\n\n# Getting Start\n\n## Setting and Analytical tools\n\n------------------------------------------------------------------------\n\nThe following R packages were used in this Take-Home exercise:\n\n-   [**tidyverse**](https://www.tidyverse.org/) (i.e. readr, tidyr, dplyr, ggplot2) for performing data science tasks such as importing, tidying, and wrangling data, as well as creating graphics based on The Grammar of Graphics;\n\n-   **SmartEDA** for automated EDA reporting and data profiling\n\n-   **easystats** for streamlining statistical analyses and modeling\n\n-   **gtsummary** for creating publication-ready analytical and summary tables\n\n-   **ggstatsplot** for creating statistical graphics with detailed statistical information\n\n-   **patchwork** for combine multiple ggplot2 into a single composition\n\nCode chunk below will be used to check if these packages have been installed and also will load them onto R environment.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse,SmartEDA,easystats, gtsummary,ggstatsplot,patchwork)\n```\n:::\n\n\n\n## Importing data\n\n------------------------------------------------------------------------\n\nThe code chunk below imports *japan_heart_attack_dataset.csv* into R environment by using read_csv() function of readr package. readr is one fo the tidyverse package.\n\nThe data set used in this exercise is [Heart Attack in Youth Vs Adult](https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult), the dataset includes various health metrics, lifestyle factors and demographic information.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheartattack <- read_csv(\"data/japan_heart_attack_dataset.csv\")\n```\n:::\n\n\n\n## Data Processing\n\n------------------------------------------------------------------------\n\n### Checking for duplicate\n\nThe below code chunk will show the count of duplicated rows in the dataset.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(duplicated(heartattack))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n\n\n\\[1\\] 0 indicates there are no duplicated records in the data, confirming each row represents a unique observation.\n\n### Checking for missing value\n\nThe below code chunk examines missing values in the dataset. The results shows that there are no missing values (0) across all variables in the dataset.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolSums(is.na(heartattack))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    Age                  Gender                  Region \n                      0                       0                       0 \n        Smoking_History        Diabetes_History    Hypertension_History \n                      0                       0                       0 \n      Cholesterol_Level       Physical_Activity            Diet_Quality \n                      0                       0                       0 \n    Alcohol_Consumption           Stress_Levels                     BMI \n                      0                       0                       0 \n             Heart_Rate             Systolic_BP            Diastolic_BP \n                      0                       0                       0 \n         Family_History Heart_Attack_Occurrence          Extra_Column_1 \n                      0                       0                       0 \n         Extra_Column_2          Extra_Column_3          Extra_Column_4 \n                      0                       0                       0 \n         Extra_Column_5          Extra_Column_6          Extra_Column_7 \n                      0                       0                       0 \n         Extra_Column_8          Extra_Column_9         Extra_Column_10 \n                      0                       0                       0 \n        Extra_Column_11         Extra_Column_12         Extra_Column_13 \n                      0                       0                       0 \n        Extra_Column_14         Extra_Column_15 \n                      0                       0 \n```\n\n\n:::\n:::\n\n\n\n### Data exploration\n\nThe initial exploration using `ExpData(type=1)` reveals the following characteristics of the *japan_heart_attack_dataset*. It is able to see that the dataset consist of 30,000 rows and 32 columns.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheartattack%>%\n  ExpData(type=1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                          Descriptions     Value\n1                                   Sample size (nrow)     30000\n2                              No. of variables (ncol)        32\n3                    No. of numeric/interger variables        22\n4                              No. of factor variables         0\n5                                No. of text variables        10\n6                             No. of logical variables         0\n7                          No. of identifier variables        20\n8                                No. of date variables         0\n9             No. of zero variance variables (uniform)         0\n10               %. of variables having complete cases 100% (32)\n11   %. of variables having >0% and <50% missing cases    0% (0)\n12 %. of variables having >=50% and <90% missing cases    0% (0)\n13          %. of variables having >=90% missing cases    0% (0)\n```\n\n\n:::\n:::\n\n\n\nThere are total 22 number variables and 10 categorical variables in the dataset.\n\nThe `ExpData(type=2)` describe the variables characteristics. The Numerical Variables includes Age, Cholesterol_Level, Health metrics. The categorical variables include Gender, Region, Smoking_History, Diabetes_History, Hypertension_History, Physical_Activity, Diet_Quality, Alcohol_Consumption.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheartattack%>%\n  ExpData(type=2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Index           Variable_Name Variable_Type Sample_n Missing_Count\n1      1                     Age       numeric    30000             0\n2      2                  Gender     character    30000             0\n3      3                  Region     character    30000             0\n4      4         Smoking_History     character    30000             0\n5      5        Diabetes_History     character    30000             0\n6      6    Hypertension_History     character    30000             0\n7      7       Cholesterol_Level       numeric    30000             0\n8      8       Physical_Activity     character    30000             0\n9      9            Diet_Quality     character    30000             0\n10    10     Alcohol_Consumption     character    30000             0\n11    11           Stress_Levels       numeric    30000             0\n12    12                     BMI       numeric    30000             0\n13    13              Heart_Rate       numeric    30000             0\n14    14             Systolic_BP       numeric    30000             0\n15    15            Diastolic_BP       numeric    30000             0\n16    16          Family_History     character    30000             0\n17    17 Heart_Attack_Occurrence     character    30000             0\n18    18          Extra_Column_1       numeric    30000             0\n19    19          Extra_Column_2       numeric    30000             0\n20    20          Extra_Column_3       numeric    30000             0\n21    21          Extra_Column_4       numeric    30000             0\n22    22          Extra_Column_5       numeric    30000             0\n23    23          Extra_Column_6       numeric    30000             0\n24    24          Extra_Column_7       numeric    30000             0\n25    25          Extra_Column_8       numeric    30000             0\n26    26          Extra_Column_9       numeric    30000             0\n27    27         Extra_Column_10       numeric    30000             0\n28    28         Extra_Column_11       numeric    30000             0\n29    29         Extra_Column_12       numeric    30000             0\n30    30         Extra_Column_13       numeric    30000             0\n31    31         Extra_Column_14       numeric    30000             0\n32    32         Extra_Column_15       numeric    30000             0\n   Per_of_Missing No_of_distinct_values\n1               0                    62\n2               0                     2\n3               0                     2\n4               0                     2\n5               0                     2\n6               0                     2\n7               0                 30000\n8               0                     3\n9               0                     3\n10              0                     4\n11              0                 29613\n12              0                 30000\n13              0                 30000\n14              0                 30000\n15              0                 30000\n16              0                     2\n17              0                     2\n18              0                 30000\n19              0                 30000\n20              0                 30000\n21              0                 30000\n22              0                 30000\n23              0                 30000\n24              0                 30000\n25              0                 30000\n26              0                 30000\n27              0                 30000\n28              0                 30000\n29              0                 30000\n30              0                 30000\n31              0                 30000\n32              0                 30000\n```\n\n\n:::\n:::\n\n\n\n### Converting Datatype\n\nThe code chunk below converted all the categorical variables into factor.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheartattack <- heartattack %>%\n  mutate(\n    Gender = as.factor(Gender),\n    Region = as.factor(Region),\n    Smoking_History = as.factor(Smoking_History),\n    Diabetes_History = as.factor(Diabetes_History),\n    Hypertension_History = as.factor(Hypertension_History),\n    Physical_Activity = factor(Physical_Activity, levels = c(\"Low\", \"Moderate\", \"High\")),\n    Diet_Quality = factor(Diet_Quality, levels = c(\"Poor\", \"Average\", \"Good\")),\n    Alcohol_Consumption = factor(Alcohol_Consumption, levels = c(\"None\", \"Low\", \"Moderate\", \"High\")),\n    Family_History = as.factor(Family_History),\n    Heart_Attack_Occurrence = as.factor(Heart_Attack_Occurrence)\n  )\n```\n:::\n\n\n\n### Categorization of variable\n\nThe code chunk below create a new categorical variable 'Age_Group'. The cut function() to create age groups:\n\n-   18-30\": Ages up to 30\n-   \"31-40\": Ages 31 to 40\n-   \"41-50\": Ages 41 to 50\n-   \"51-60\": Ages 51 to 60\n-   \"Over 60\": Ages above 60\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheartattack <- heartattack %>%\n  mutate(Age_Group = cut(Age, \n                           breaks = c(0, 30, 40, 50, 60, 100),\n                           labels = c(\"18-30\", \"31-40\", \"41-50\", \"51-60\", \"Over 60\"),\n                           right = FALSE))\n```\n:::\n\n\n\nThe more detail Age\\_ Group would allow better understanding of age-related cardiovascular risk patterns.\n\n# Exploratory Data Analysis\n\n## Visualization 1: Distribution with Categorical Variables\n\n------------------------------------------------------------------------\n\nThe below code chunk create a series plot for a comprehensive view of the distribution of categorical variables. This visualization shows relative proportions of each category.\n\nThe key categorical variables includes:\n\n-   Grouped Age Categories (\"18-30\", \"31-40\", \"41-50\", \"51-60\", \"Over 60\")\n-   Gender (Male/Female)\n-   Region (Urban/Rural)\n-   Health History (Yes/No for):\n    -   Smoking\n\n    -   Diabetes\n\n    -   Hypertension\n\n    -   Family History\n-   Lifestyle Factors:\n    -   Physical Activity (Low/Moderate/High)\n\n    -   Diet Quality (Poor/Average/Good)\n\n    -   Alcohol Consumption (None/Low/Moderate/High)\n-   Heart Attack Occurrence (Yes/No)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheartattack %>%\n  ExpCatViz(target = NULL, \n            col = \"sky blue\",\n            clim = 10,\n            margin = 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[2]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[3]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[4]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[5]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-5.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[6]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[7]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-7.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[8]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-8.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[9]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-9.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[10]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-10.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[11]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-9-11.png){width=672}\n:::\n:::\n\n\n\nThe study population shows an equal gender distribution and a predominantly urban representation of 70%. with largest age group being those over 60. Health risk factors indicate that while 70% are non-smokers, there are significant proportions with medical histories of diabetes (20%), hypertension (25%), and family history of heart conditions (30%). Lifestyle factors present a relatively healthy profile, with 40% reporting moderate physical activity and 80% maintaining average to good diet quality. Alcohol consumption patterns show a preference for moderate intake (40%), followed by low consumption (30%). The dataset records a 10% heart attack occurrence rate, providing valuable insights into cardiovascular health patterns across different age groups in the Japanese population.\n\n## **Visualization 2: One-sample test: Cholesterol Level**\n\n------------------------------------------------------------------------\n\nAccording to most medical guidelines, a health total cholesterol level is consider to be less than 200mg/dL. A level of 200 mg/dL is often considered borderline high. The below hypothesis was formed based using the standard 200mg/dL. The test helps determine if the sampling Japanese population's cholesterol levels significantly deviate from the internationally recgonized healthy threshold, providing insights into cardiovascular risk patterns in the population.\n\nHypothesis:\n\nH0: The mean cholesterol level in the Japanese population is equal to 200 mg/dL (standard threshold)\n\nH1: The mean cholesterol level in the Japanese population is different from 200 mg/dL\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\n\n\ngghistostats(\n  data = heartattack,\n  x = Cholesterol_Level,\n  type = \"bayes\",\n  test.value = 200,  # Standard threshold for cholesterol\n  xlab = \"Cholesterol Level (mg/dL)\",\n  title = \"Distribution of Cholesterol Levels with Bayesian Test\",\n  subtitle = \"Testing against reference value of 200 mg/dL\",\n  bf.message = TRUE, \n  results.subtitle = TRUE, \n  binwidth = 10\n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\nBased on the Bayesian analysis of cholesterol levels in the Japanese population, several key findings emerge:\n\nThe distribution of cholesterol levels follows a roughly normal distribution with a median of 196.52 mg/dL, slightly below the medical guideline threshold of 200 mg/dL. The Bayesian test results (log₁₀(BF₁₀) = 4.87) provide very strong evidence supporting the alternative hypothesis that the population mean differs from 200 mg/dL. The 95% credible interval \\[-0.44, 0.24\\] indicates the uncertainty range around the estimated difference. The majority of the sample falls between 150-250 mg/dL, with relatively few individuals having extreme values below 100 or above 300 mg/dL. This suggests that while many Japanese individuals maintain cholesterol levels near the recommended threshold, there is significant variation within the population, with some individuals requiring monitoring or intervention for elevated cholesterol levels.\n\n## Visualization 3: Two-sample mean test: Cardiovascular risk factors across different age groups\n\n------------------------------------------------------------------------\n\nThe hypothesis was formed aim to reflect on the possibility of differences across multiple age groups. The analysis will help identify how risk factors vary across different life stages and potential age-specific intervention points for cardiovascular health.\n\nHypothesis:\n\nH0: There is no difference in cardiovascular risk factors across different age groups (18-30, 31-40, 41-50, 51-60, Over 60) in the Japanese population\n\nH1: There is a significant difference in cardiovascular risk factors in at least one age group compared to the others in the Japanese population\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_theme <- theme(\n    axis.text = element_text(size = 6),         \n    axis.title = element_text(size = 8),       \n    plot.title = element_text(size = 10),        \n    text = element_text(size = 6),              \n    plot.subtitle = element_text(size = 5),     \n    plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), \"cm\")\n) \n    \np1 <- ggbetweenstats(\n data = heartattack,\n x = Age_Group,  \n y = Cholesterol_Level,\n type = \"np\",\n title = \"Cholesterol Levels by Age Group\",\n messages = FALSE,\n annotation.args = list(subtitle = \"simple\"), # Simplify statistical annotation\n results.subtitle = FALSE # Remove detailed results\n) + my_theme\n\np2 <- ggbetweenstats(\n data = heartattack,\n x = Age_Group,\n y = BMI, \n type = \"np\",\n title = \"BMI by Age Group\",\n messages = FALSE,\n annotation.args = list(subtitle = \"simple\"),\n results.subtitle = FALSE\n) + my_theme\n\np3 <- ggbetweenstats(\n data = heartattack,\n x = Age_Group,\n y = Systolic_BP,\n type = \"np\", \n title = \"Systolic BP by Age Group\",\n messages = FALSE,\n annotation.args = list(subtitle = \"simple\"),\n results.subtitle = FALSE\n) + my_theme\n\np4 <- ggbetweenstats(\n data = heartattack,\n x = Age_Group,\n y = Heart_Rate,\n type = \"np\",\n title = \"Heart Rate by Age Group\", \n messages = FALSE,\n annotation.args = list(subtitle = \"simple\"),\n results.subtitle = FALSE\n) + my_theme\n\n# Combine plots\np1 + p2 + p3 + p4\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\nThe analysis of cardiovascular risk factors across age groups in the Japanese population reveals distinct patterns. Cholesterol levels show minimal variation across age groups, with medians ranging from 199.51 mg/dL (18-30) to 200.34 mg/dL (Over 60), hovering around the medical guideline threshold. BMI demonstrates a clear increasing trend with age, from 25.12 in the youngest group to 24.97 in the oldest, although all groups maintain BMI within the overweight range for Asian populations. Systolic blood pressure shows an upward trend with age, ranging from 119.79 mmHg (18-30) to 120.17 mmHg (Over 60). Heart rate remains relatively stable across age groups, with only slight variations (70.10 bpm in 18-30 to 69.67 bpm in Over 60). These patterns indicate that while aging significantly influences BMI and blood pressure, cholesterol levels and heart rate remain relatively stable across age groups.\n\n## Visualization 4: One way ANOVA Test: Difference in cardiovascular risk factor among age groups with different lifestyle habits\n\n------------------------------------------------------------------------\n\nThis hypothesis structure examines the complex relationship between cardiovascular risk factors including Cholesterol levels, Blood Pressure (Systolic) and BMI(Body Mass Index) , Age group and Lifestyle habits including Physical Activity, Diet Quality, Alcohol Consumption and Smoking History. The hypothesis testing aim to help in understanding both independent and interactive effects of age and lifestyle on cardiovascular health in the Japanese population.\n\nHypothesis:\n\nH0: There is no difference in cardiovascular risk factors (Cholesterol, BP, BMI) among age groups with different lifestyle habits\n\nH1: There is a difference in cardiovascular risk factors in at least one age-lifestyle group combination\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1. Analysis of Cholesterol Levels across Physical Activity levels by Age Groups\nggbetweenstats(\n data = heartattack %>% \n   filter(Physical_Activity %in% c(\"Low\", \"Moderate\", \"High\")),\n x = Physical_Activity,\n y = Cholesterol_Level,\n type = \"p\",\n title = \"Cholesterol Levels by Physical Activity Across Age Groups\",\n xlab = \"Physical Activity Level\", \n ylab = \"Cholesterol Level (mg/dL)\",\n messages = FALSE,\n facet.by = \"Age_Group\"\n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# 2. BMI patterns across lifestyle habits by Age Groups \nggbetweenstats(\n data = heartattack,\n x = Diet_Quality,\n y = BMI,\n type = \"p\",\n title = \"BMI Distribution by Diet Quality Across Age Groups\",\n xlab = \"Diet Quality\",\n ylab = \"BMI\",\n messages = FALSE,\n facet.by = \"Age_Group\"\n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# 3. Blood Pressure responses across Stress Categories by Age Groups\nheartattack <- heartattack %>%\n  mutate(Stress_Category = cut(Stress_Levels,\n                              breaks = c(-Inf, 3, 6, Inf),\n                              labels = c(\"Low\", \"Medium\", \"High\")))\n\nggbetweenstats(\n  data = heartattack,\n  x = Stress_Category,\n  y = Systolic_BP,\n  type = \"p\",\n  title = \"Blood Pressure Response to Stress Across Age Groups\",\n  xlab = \"Stress Level\",\n  ylab = \"Systolic BP (mmHg)\",\n  messages = FALSE,\n  facet.by = \"Age_Group\"\n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-12-3.png){width=672}\n:::\n:::\n\n\n\nCholesterol Levels by Physical Activity: The visualization reveals minimal variation in cholesterol levels across physical activity categories, with means hovering around 200 mg/dL (Low: 199.96, Moderate: 200.04, High: 199.66). The violin plots show similar distribution patterns across all activity levels, with no statistically significant differences (p = 0.64). This suggests that physical activity level alone may not have a strong direct relationship with cholesterol levels in the Japanese population studied.\n\nBMI Distribution by Diet Quality: BMI distributions show a slight upward trend with improving diet quality (Poor: 24.94, Average: 25.00, Good: 25.02), though differences are not statistically significant (p = 0.54). The violin plots demonstrate consistent spread patterns across diet categories, suggesting that diet quality alone might not be a primary determinant of BMI in this population.\n\nBlood Pressure Response to Stress: Systolic blood pressure shows significant variation across stress levels (p = 0.04), with means ranging from 119.71 to 120.15 mmHg. The violin plots reveal similar distribution patterns but with subtle differences in central tendencies, indicating that stress levels may influence blood pressure measurements, though the magnitude of effect appears modest.\n\n## **Visualization 5: Significant Test of Association (Dependence): Associate between age groups and cardiovascular risk factors**\n\n------------------------------------------------------------------------\n\nHypotheses for Significant Tests of Association\n\nCholesterol Level:\n\nH0: There is no association between age groups (18-30, 31-40, 41-50, 51-60, Over 60) and cholesterol level categories (Normal, Borderline, High)\n\nH1: There is a significant association between age groups and cholesterol level categories\n\nBMI :\n\nH0: There is no association between age groups and BMI categories (Underweight, Normal, Overweight, Obese)\n\nH1: There is a significant association between age groups and BMI categories\n\nBlood Pressure :\n\nH0: There is no association between age groups and blood pressure categories (Normal, Elevated, High) H1: There is a significant association between age groups and blood pressure categories\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Prepare data with categories\nheartattack_cat <- heartattack %>%\n  mutate(\n    Cholesterol_Category = cut(Cholesterol_Level,\n                             breaks = c(0, 200, 239, 500),\n                             labels = c(\"Normal\", \"Borderline\", \"High\")),\n    BMI_Category = cut(BMI,\n                      breaks = c(0, 18.5, 23, 25, 30, 100),\n                      labels = c(\"Underweight\", \"Normal\", \"Overweight\", \"Obese\", \"Severely Obese\")),\n    BP_Category = cut(Systolic_BP,\n                     breaks = c(0, 120, 140, 300),\n                     labels = c(\"Normal\", \"Elevated\", \"High\"))\n  )\n\n\n# Cholesterol\np1 <- ggbarstats(\n  data = heartattack_cat,\n  x = Age_Group,\n  y = Cholesterol_Category,\n  type = \"np\",\n  title = \"Association: Age Groups and Cholesterol Categories\",\n  messages = FALSE\n)\n\n# BMI\np2 <- ggbarstats(\n  data = heartattack_cat,\n  x = Age_Group,\n  y = BMI_Category,\n  type = \"np\",\n  title = \"Association: Age Groups and BMI Categories\",\n  messages = FALSE\n)\n\n# Blood Pressure\np3 <- ggbarstats(\n  data = heartattack_cat,\n  x = Age_Group,\n  y = BP_Category,\n  type = \"np\",\n  title = \"Association: Age Groups and Blood Pressure Categories\",\n  messages = FALSE\n)\n\np1\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\np2\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n\n```{.r .cell-code}\np3\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-13-3.png){width=672}\n:::\n:::\n\n\n\nThe above plots shows the association between age groups and cardiovascular risk factors reveals several important patterns:\n\nCholesterol Categories:\n\n-   Distribution across Normal, Borderline, and High categories shows consistent patterns\n\n-   Over 60 age group has the highest proportion (32-33%) across all categories\n\n-   Youngest group (18-30) maintains about 19% across categories\n\n-   Middle age groups (31-50) show stable distributions around 16-17%\n\n-   Statistical significance indicated by extremely low p-values\n\nBMI Categories:\n\n-   Remarkable consistency in age group distributions across all BMI categories\n\n-   Over 60 group shows highest percentages (32-33%) in all categories\n\n-   Consistent representation of 18-30 age group (18-20%)\n\n-   Middle age groups maintain stable proportions\n\n-   Strong statistical evidence of association (log₁₀(BF₁₀) = 48.06)\n\nBlood Pressure Categories\n\n-   Similar patterns across Normal, Elevated, and High categories\n\n-   Over 60 group shows slightly lower representation (30%) in High category\n\n-   Younger age groups maintain consistent proportions\n\n-   Strong statistical evidence for association\n\n-   Slight variations in distribution patterns compared to other risk factors\n\nThese visualizations demonstrate strong associations between age groups and cardiovascular risk factors, with consistent patterns across different health metrics.\n\n## Visualization 6: Parallel Coordinates for Heart Attack Risk Factor\n\n------------------------------------------------------------------------\n\nThe object of this visualization is to compare cardiovascular risk factors across different age groups and identify the trends and patterns in risk factor variations.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Prepare data for parallel coordinates\nrisk_factors <- heartattack %>%\n  select(Age_Group, Cholesterol_Level, BMI, \n         Systolic_BP, Heart_Rate, Stress_Levels) %>%\n  gather(key = \"Variable\", value = \"Value\", -Age_Group)\n\n# Enhanced parallel coordinates plot\nggplot(risk_factors, \n       aes(x = Variable, y = Value, group = Age_Group, color = Age_Group)) +\n  geom_line(size = 1.2, alpha = 0.7) +  # Increased line thickness\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1, size = 10),\n    legend.position = \"right\",\n    plot.title = element_text(size = 14, face = \"bold\"),\n    panel.grid.major = element_line(color = \"gray90\")\n  ) +\n  labs(title = \"Cardiovascular Risk Factors Across Age Groups\",\n       subtitle = \"Parallel Coordinates View\",\n       y = \"Standardized Values\",\n       x = \"Risk Factors\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\nThere are several key pattern observed from the parallel coordinates:\n\n-   Cholesterol Level: Shows the highest standardized values among all risk factors, with slight variations across age groups, particularly higher levels in the 41-50 and Over 60 age groups.\n-   BMI: Demonstrates relatively consistent patterns across age groups, with all groups showing moderate standardized values.\n-   Heart Rate: Shows moderate variation across age groups, with slightly higher rates in younger age groups (18-30, 31-40) compared to older groups.\n\n<!-- -->\n\n-   Stress Levels: Exhibits the lowest standardized values among all factors, with minimal variation across age groups.\n-   Systolic BP: Shows moderate values with a slight increasing trend in older age groups, particularly in the Over 60 category.\n\n# Conclusion\n\n------------------------------------------------------------------------\n\nIn conclusion, the **ggplot2** package and its extensions like ggstatsplot proved to be powerful tools for exploratory data analysis through visualization. The Japanese heart attack dataset provides valuable insights into cardiovascular health patterns across age groups and risk factors. The analysis revealed significant associations between age groups and various cardiovascular risk categories, with distinct patterns emerging particularly in the Over-60 age group. The visualizations effectively demonstrated the complex relationships between lifestyle factors and health metrics, though some associations were weaker than initially expected. Future research could benefit from more detailed statistical analyses and exploration of additional lifestyle factors to strengthen these observations. This exercise showcased the versatility of ggplot2 in creating both simple and complex visualizations for comprehensive health data analysis.\n\n# Reference\n\n------------------------------------------------------------------------\n\n-   [Heart Attack](https://www.singhealth.com.sg/patient-care/conditions-treatments/heart-attack)\n\n-   [Cholesterol Management](https://www.singhealth.com.sg/patient-care/conditions-treatments/cholesterol-management)\n\n-   [Heart attack in Japan youth vs adult](https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult)\n\n-   [R for Visual Analytics](https://r4va.netlify.app/)\n",
    "supporting": [
      "Take-home_Ex1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}